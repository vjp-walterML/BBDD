-- BASE DE DATOS LIBRERIA
-- 1ºDAW
-- 21-04-2023
-- WALTER MARTIN LOPES
-- --------------------------------
CREATE DATABASE LIBRERIA;
USE LIBRERIA;

-- =====================CREACION DE TABLAS=============
CREATE TABLE CLIENTES(
COD_CLIENTE INT PRIMARY KEY,
NOMBRE VARCHAR(15) NOT NULL,
APELLIDOS VARCHAR(30) NOT NULL,
DIRECCION VARCHAR(30) NOT NULL,
POBLACION VARCHAR(25) NOT NULL,
CODIGO_POSTAL CHAR(5) NOT NULL);

CREATE TABLE LIBROS(
COD_LIBRO INT PRIMARY KEY,
GENERO_LITERARIO VARCHAR(30),
TITULO VARCHAR(30) NOT NULL,
EDITORIAL VARCHAR(25) NOT NULL,
NUMERO_PAGINAS INT CHECK(NUMERO_PAGINAS>1 AND NUMERO_PAGINAS<5000),
PRECIO DECIMAL(7,2) NOT NULL,
DESCUENTO DECIMAL(7,2));

CREATE TABLE EMPLEADOS(
COD_EMPLEADO INT PRIMARY KEY,
NOMBRE VARCHAR(15) NOT NULL,
APELLIDOS VARCHAR(30) NOT NULL,
SALARIO DECIMAL(10,2) NOT NULL,
COMISION DECIMAL(10,2));

CREATE TABLE VENTAS(
COD_VENTAS INT PRIMARY KEY,
COD_LIBRO INT NOT NULL,
COD_CLIENTE INT NOT NULL,
COD_EMPLEADO INT NOT NULL,
FECHA_VENTA DATE NOT NULL,
FOREIGN KEY COD_LIBRO_FK (COD_LIBRO) REFERENCES LIBROS(COD_LIBRO) ON UPDATE CASCADE ON DELETE CASCADE,
FOREIGN KEY COD_CLIENTE_FK (COD_CLIENTE) REFERENCES CLIENTES(COD_CLIENTE) ON UPDATE CASCADE ON DELETE CASCADE,
FOREIGN KEY COD_EMPLEADO_FK (COD_EMPLEADO) REFERENCES EMPLEADOS(COD_EMPLEADO) ON UPDATE CASCADE ON DELETE CASCADE);


#CARGA DE DATOS

/* CARGA DE DATOS EN LA TABLA CLIENTES */
INSERT INTO CLIENTES (
Cod_CLIENTE, nombre, Apellidos, Direccion, Poblacion,Codigo_postal) VALUES
(1,'ANA','GARCIA','c SOL','PLASENCIA','10600'),
(2,'LUIS','SANCHEZ','c PALMERAS','PLASENCIA','10600'),
(3,'ANTONIO','GARCIA','c LUNA','PLASENCIA','10600'),
(4,'MARIA','SÁNCHEZ','c MAYOR','PLASENCIA','10600');

/* CARGA DE DATOS EN LA TABLA LIBROS */
INSERT INTO LIBROS( cod_libro, Genero_literario , Titulo , Editorial,
Numero_paginas,precio ) VALUES
(1,'JUVENIL','AY DEL QUE SE RIA','ANAYA',125,20.25),
(2,'JUVENIL','TODO CONTROLADO','ANAYA',200,15.2),
(3,'TEATRO','LA DAMA DUENDE','PLANETA',150,14),
(4,'NOVELA','OLVIDADO REY GUDU','DESTINO',460,20),
(5,'POESIA','20 POEMAS DE AMOR','CATEDRA',150,15.00);

/* CARGA DE DATOS EN LA TABLA EMPLEADOS */
INSERT INTO EMPLEADOS (
Cod_empleado, nombre, Apellidos, salario,comision) VALUES
(1,'JOSE','GARCIA',1500.50,NULL),
(2,'LUIS','MARTINEZ',1500,2),
(3,'MARIA','RODRIGUEZ',2050,1.5);

/*CARGA DE DATOS EN LA TABLA ventas */
INSERT INTO VENTAS(
cod_ventas,cod_libro,cod_cliente,cod_empleado,FECHA_venta) VALUES
(1,3,1,1,'2018/02/15'),
(2,1,2,2,'2018/03/02'),
(3,2,1,3,'2018/03/03'),
(4,4,4,1,'2018/03/07'),
(5,5,3,2,'2018/03/15'),
(6,1,4,3,'2018/03/15');

-- -------------------------------------